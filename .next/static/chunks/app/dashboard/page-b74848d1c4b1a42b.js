(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{54:(e,t,s)=>{Promise.resolve().then(s.bind(s,7405))},7405:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>J});var a=s(5155),r=s(2115),n=s(7909),l=s(63),i=s(2056),c=s(598),o=s(5733),d=s(2893),m=s(1873),x=s(4157),u=s(906),h=s(6907),p=s(3209),g=s(7003),f=s(3101),v=s(5016);let b=(0,f.F)("inline-flex items-center rounded-full border border-slate-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 dark:border-slate-800 dark:focus:ring-slate-300",{variants:{variant:{default:"border-transparent bg-slate-900 text-slate-50 hover:bg-slate-900/80 dark:bg-slate-50 dark:text-slate-900 dark:hover:bg-slate-50/80",secondary:"border-transparent bg-slate-100 text-slate-900 hover:bg-slate-100/80 dark:bg-slate-800 dark:text-slate-50 dark:hover:bg-slate-800/80",destructive:"border-transparent bg-red-500 text-slate-50 hover:bg-red-500/80 dark:bg-red-900 dark:text-slate-50 dark:hover:bg-red-900/80",outline:"text-slate-950 dark:text-slate-50",success:"border-transparent bg-emerald-500 text-white hover:bg-emerald-500/80",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-500/80",danger:"border-transparent bg-orange-500 text-white hover:bg-orange-500/80"}},defaultVariants:{variant:"default"}});function w(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,v.cn)(b({variant:s}),t),...r})}var j=s(1343);let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(j.bL,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-slate-900 data-[state=unchecked]:bg-slate-200 dark:focus-visible:ring-slate-300 dark:focus-visible:ring-offset-slate-950 dark:data-[state=checked]:bg-slate-50 dark:data-[state=unchecked]:bg-slate-800",s),...r,ref:t,children:(0,a.jsx)(j.zi,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0 dark:bg-slate-950")})})});y.displayName=j.bL.displayName;var N=s(6983);let k=(0,s(5959).v)(e=>({logs:[],addLog:(t,s)=>{let a=new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),r={id:"".concat(Date.now(),"-").concat(Math.random()),time:a,event:t,type:s,timestamp:Date.now()};e(e=>({logs:[r,...e.logs].slice(0,10)}))},clearLogs:()=>e({logs:[]})}));function S(){let{logs:e}=k();return(0,a.jsxs)(p.Zp,{children:[(0,a.jsx)(p.aR,{className:"pb-3",children:(0,a.jsxs)(p.ZB,{className:"text-sm flex items-center gap-2 text-slate-500",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"Recent Activity"]})}),(0,a.jsx)(p.Wu,{children:0===e.length?(0,a.jsx)("p",{className:"text-sm text-slate-400 text-center py-4",children:"No activity yet. Start your trip to see events."}):(0,a.jsx)("div",{className:"relative border-l border-slate-200 dark:border-slate-800 ml-3 space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"relative pl-4",children:[(0,a.jsx)("div",{className:"absolute -left-1.5 top-1.5 w-3 h-3 rounded-full border-2 border-white dark:border-slate-950 ".concat("danger"===e.type?"bg-red-500":"warning"===e.type?"bg-yellow-500":"success"===e.type?"bg-green-500":"bg-slate-300 dark:bg-slate-600")}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mb-0.5",children:e.time}),(0,a.jsx)("p",{className:"text-sm font-medium",children:e.event})]},e.id))})})]})}var M=s(7910),A=s(3327);let E=[{icon:M.A,title:"Keep Safe Distance",desc:"Maintain at least 3 seconds gap from the vehicle ahead."},{icon:i.A,title:"Reduce Speed",desc:"Wet roads increase braking distance by 2x."},{icon:A.A,title:"Use Headlights",desc:"Turn on low beams in fog or heavy rain."}];function C(){return(0,a.jsxs)(p.Zp,{className:"bg-emerald-50 dark:bg-emerald-950/20 border-emerald-200 dark:border-emerald-900",children:[(0,a.jsx)(p.aR,{className:"pb-3",children:(0,a.jsxs)(p.ZB,{className:"text-emerald-800 dark:text-emerald-500 text-sm flex items-center gap-2",children:[(0,a.jsx)(M.A,{className:"w-4 h-4"}),"Safety Guidelines"]})}),(0,a.jsx)(p.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:E.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"mt-0.5 text-emerald-600 dark:text-emerald-400",children:(0,a.jsx)(e.icon,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-emerald-900 dark:text-emerald-300",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-emerald-700 dark:text-emerald-600/80",children:e.desc})]})]},t))})})]})}var D=s(5229),R=s(9141);function I(e){let{isOpen:t,onCancel:s,onConfirm:r,countdown:n,crashType:l="unknown",confidence:c}=e;if(!t)return null;let o={frontal:"FRONTAL IMPACT",side:"SIDE IMPACT",rear:"REAR IMPACT",rollover:"ROLLOVER DETECTED",unknown:"CRASH DETECTED"}[l],d={frontal:"\uD83D\uDCA5",side:"⚠️",rear:"\uD83D\uDE97",rollover:"\uD83D\uDD04",unknown:"\uD83D\uDEA8"}[l],m=c&&c>=80?"text-red-200":c&&c>=60?"text-yellow-200":"text-orange-200";return(0,a.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/90 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md animate-pulse rounded-3xl border-4 border-red-500 bg-gradient-to-br from-red-600 to-red-800 p-8 shadow-2xl",children:[(0,a.jsx)("div",{className:"absolute inset-0 animate-ping rounded-3xl border-4 border-red-500 opacity-20"}),(0,a.jsxs)("div",{className:"relative z-10 text-center text-white",children:[(0,a.jsx)("div",{className:"mx-auto mb-6 flex h-24 w-24 items-center justify-center rounded-full bg-white/20 backdrop-blur",children:(0,a.jsx)(i.A,{className:"h-16 w-16 animate-bounce text-white"})}),(0,a.jsxs)("h1",{className:"mb-2 text-4xl font-black uppercase tracking-tight",children:[d," ",o]}),"unknown"!==l&&(0,a.jsx)("p",{className:"mb-2 text-sm font-medium opacity-90",children:"rollover"===l?"Vehicle rollover detected":"".concat(l.charAt(0).toUpperCase()+l.slice(1)," collision detected")}),c&&(0,a.jsxs)("p",{className:"mb-4 text-xs font-semibold ".concat(m),children:["Detection Confidence: ",Math.round(c),"%"]}),(0,a.jsx)("p",{className:"mb-6 text-xl font-semibold",children:"Are you okay?"}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("div",{className:"mx-auto mb-3 flex h-32 w-32 items-center justify-center rounded-full border-8 border-white bg-red-900",children:(0,a.jsx)("span",{className:"text-6xl font-black",children:n})}),(0,a.jsxs)("p",{className:"text-lg",children:["Calling emergency services in ",n," seconds"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(g.$,{onClick:s,size:"lg",className:"w-full rounded-full bg-green-500 py-6 text-xl font-bold text-white hover:bg-green-600",children:[(0,a.jsx)(D.A,{className:"mr-2 h-6 w-6"}),"I'M OKAY - CANCEL"]}),(0,a.jsxs)(g.$,{onClick:r,size:"lg",variant:"outline",className:"w-full rounded-full border-2 border-white bg-transparent py-6 text-xl font-bold text-white hover:bg-white/20",children:[(0,a.jsx)(R.A,{className:"mr-2 h-6 w-6"}),"CALL HELP NOW"]})]})]})]})})}function T(e){let{onTriggerSOS:t}=e,[s,n]=(0,r.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{n(!0),"vibrate"in navigator&&navigator.vibrate(200)},className:"fixed bottom-8 right-8 z-40 flex h-20 w-20 items-center justify-center rounded-full bg-gradient-to-br from-red-600 to-red-700 shadow-2xl transition-all hover:scale-110 hover:shadow-red-500/50 active:scale-95","aria-label":"Emergency SOS",children:[(0,a.jsx)("div",{className:"absolute inset-0 animate-ping rounded-full bg-red-500 opacity-20"}),(0,a.jsxs)("div",{className:"relative flex flex-col items-center",children:[(0,a.jsx)(R.A,{className:"h-8 w-8 text-white"}),(0,a.jsx)("span",{className:"mt-1 text-xs font-bold text-white",children:"SOS"})]})]}),s&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"relative w-full max-w-md rounded-3xl border-2 border-red-500 bg-gradient-to-br from-slate-900 to-slate-950 p-8 shadow-2xl",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-red-500/20",children:(0,a.jsx)(R.A,{className:"h-10 w-10 text-red-500"})}),(0,a.jsx)("h2",{className:"mb-4 text-2xl font-bold text-white",children:"Send Emergency Alert?"}),(0,a.jsx)("p",{className:"mb-8 text-slate-300",children:"This will:"}),(0,a.jsxs)("ul",{className:"mb-8 space-y-2 text-left text-sm text-slate-400",children:[(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-red-500",children:"•"}),(0,a.jsx)("span",{children:"Call emergency services (112)"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-red-500",children:"•"}),(0,a.jsx)("span",{children:"Send your location to emergency contacts"})]}),(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{className:"text-red-500",children:"•"}),(0,a.jsx)("span",{children:"Show nearby hospitals"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(g.$,{onClick:()=>{n(!1)},variant:"outline",className:"flex-1 rounded-full border-slate-600 text-slate-300 hover:bg-slate-800",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,a.jsxs)(g.$,{onClick:()=>{n(!1),t()},className:"flex-1 rounded-full bg-red-600 text-white hover:bg-red-700",children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"}),"Send SOS"]})]})]})})})]})}var H=s(6154);function L(e){let{harshBrakeCount:t,harshAccelCount:s,speedingCount:r,safetyScore:n=100}=e,l=Math.max(0,100-5*t-3*s-10*r),o=n||l,d=o>=90?{text:"Excellent",variant:"success"}:o>=80?{text:"Good",variant:"success"}:o>=60?{text:"Fair",variant:"warning"}:{text:"Needs Improvement",variant:"danger"};return(0,a.jsxs)(p.Zp,{className:"border-slate-800 bg-slate-900/80",children:[(0,a.jsxs)(p.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,a.jsx)(p.ZB,{className:"text-sm font-medium text-slate-200",children:"Driving Behavior"}),(0,a.jsx)(c.A,{className:"h-5 w-5 text-slate-400"})]}),(0,a.jsxs)(p.Wu,{children:[(0,a.jsxs)("div",{className:"mb-4 text-center",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-center gap-2",children:[(0,a.jsx)("span",{className:"text-4xl font-bold ".concat(o>=80?"text-green-400":o>=60?"text-yellow-400":"text-red-400"),children:o}),(0,a.jsx)("span",{className:"text-2xl text-slate-500",children:"/100"})]}),(0,a.jsx)(w,{variant:d.variant,className:"text-xs",children:d.text})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 border-t border-slate-800 pt-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-2 flex items-center justify-center",children:(0,a.jsx)("div",{className:"rounded-full p-2 ".concat(t>5?"bg-red-500/20":t>2?"bg-yellow-500/20":"bg-green-500/20"),children:(0,a.jsx)(i.A,{className:"h-4 w-4 ".concat(t>5?"text-red-400":t>2?"text-yellow-400":"text-green-400")})})}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-100",children:t}),(0,a.jsx)("p",{className:"text-[10px] text-slate-500",children:"Harsh Brakes"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-2 flex items-center justify-center",children:(0,a.jsx)("div",{className:"rounded-full p-2 ".concat(s>5?"bg-red-500/20":s>2?"bg-yellow-500/20":"bg-green-500/20"),children:(0,a.jsx)(H.A,{className:"h-4 w-4 ".concat(s>5?"text-red-400":s>2?"text-yellow-400":"text-green-400")})})}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-100",children:s}),(0,a.jsx)("p",{className:"text-[10px] text-slate-500",children:"Rapid Accels"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-2 flex items-center justify-center",children:(0,a.jsx)("div",{className:"rounded-full p-2 ".concat(r>3?"bg-red-500/20":r>1?"bg-yellow-500/20":"bg-green-500/20"),children:(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(r>3?"text-red-400":r>1?"text-yellow-400":"text-green-400")})})}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-100",children:r}),(0,a.jsx)("p",{className:"text-[10px] text-slate-500",children:"Speeding"})]})]}),o<80&&(0,a.jsx)("div",{className:"mt-4 rounded-lg bg-yellow-500/10 p-3 text-xs text-yellow-400",children:"\uD83D\uDCA1 Tip: Smooth driving improves safety score and saves fuel!"})]})]})}var z=s(9e3),G=s(5921);function O(e){let{isActive:t,duration:s,onStart:r,onStop:n}=e;return(0,a.jsx)("div",{className:"flex items-center gap-3",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-emerald-500/30 bg-emerald-500/10 px-4 py-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-emerald-400"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-emerald-400",children:"Trip Duration"}),(0,a.jsx)("span",{className:"text-sm font-bold text-emerald-300",children:(e=>{let t=Math.floor(e/60),s=Math.floor(e%60);return t>0?"".concat(t,"h ").concat(s,"m"):"".concat(s,"m")})(s)})]})]}),(0,a.jsxs)(g.$,{onClick:n,variant:"outline",className:"rounded-full border-red-500/50 bg-red-500/10 text-red-400 hover:bg-red-500/20 hover:text-red-300",children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"End Trip"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.$,{onClick:r,className:"rounded-full bg-emerald-500 text-white hover:bg-emerald-600",children:[(0,a.jsx)(G.A,{className:"mr-2 h-4 w-4"}),"Start Trip"]}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Start tracking your journey"})]})})}var F=s(9587);function P(e){let{isOpen:t,level:s,message:r,drivingTime:n,onDismiss:l,onFindRestStop:c}=e;if(!t)return null;let o="critical"===s;return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"relative w-full max-w-md rounded-3xl border-2 p-8 shadow-2xl ".concat(o?"border-red-500 bg-gradient-to-br from-red-900/90 to-red-950/90":"border-yellow-500 bg-gradient-to-br from-yellow-900/90 to-yellow-950/90"),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full ".concat(o?"bg-red-500/20":"bg-yellow-500/20"),children:o?(0,a.jsx)(i.A,{className:"h-10 w-10 animate-pulse text-red-400"}):(0,a.jsx)(F.A,{className:"h-10 w-10 text-yellow-400"})}),(0,a.jsx)("h2",{className:"mb-2 text-2xl font-bold ".concat(o?"text-red-300":"text-yellow-300"),children:o?"⚠️ MANDATORY REST":"☕ Take a Break"}),(0,a.jsx)("p",{className:"mb-4 text-3xl font-bold text-white",children:n}),(0,a.jsx)("p",{className:"mb-6 text-slate-200",children:r}),(0,a.jsxs)("div",{className:"mb-6 rounded-lg bg-black/30 p-4 text-left text-sm text-slate-300",children:[(0,a.jsx)("p",{className:"mb-2 font-semibold",children:"Safety Tips:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"• Park safely off the road"}),(0,a.jsx)("li",{children:"• Stretch your legs for 5-10 minutes"}),(0,a.jsx)("li",{children:"• Drink water or coffee"}),(0,a.jsx)("li",{children:"• Rest your eyes"}),o&&(0,a.jsx)("li",{className:"text-red-300",children:"• Take at least 15 minutes break"})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(g.$,{onClick:c,className:"w-full rounded-full py-6 text-white ".concat(o?"bg-red-600 hover:bg-red-700":"bg-yellow-600 hover:bg-yellow-700"),children:[(0,a.jsx)(F.A,{className:"mr-2 h-5 w-5"}),"Find Nearby Rest Stops"]}),!o&&(0,a.jsxs)(g.$,{onClick:l,variant:"outline",className:"w-full rounded-full border-slate-600 text-slate-300 hover:bg-slate-800",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4"}),"I'll Take a Break Soon"]})]}),o&&(0,a.jsx)("p",{className:"mt-4 text-xs text-red-300",children:"⚠️ Continuing to drive while fatigued is dangerous and illegal in many regions"})]})})})}var _=s(2203),U=s(897),B=s(8716),W=s(952);function Z(e){let{isOpen:t,type:s,name:n,message:l,speedLimit:c,onDismiss:o}=e;return(r.useEffect(()=>{if(t){let e=setTimeout(()=>{o()},8e3);return()=>clearTimeout(e)}},[t,o]),t)?(0,a.jsx)("div",{className:"fixed top-20 left-1/2 z-40 w-full max-w-md -translate-x-1/2 px-4 animate-in slide-in-from-top-5 duration-500",onClick:o,children:(0,a.jsxs)("div",{className:"relative rounded-2xl border-2 bg-gradient-to-br p-6 shadow-2xl ".concat((()=>{switch(s){case"school":return"from-yellow-900/95 to-yellow-950/95 border-yellow-500";case"hospital":return"from-red-900/95 to-red-950/95 border-red-500";case"religious":return"from-purple-900/95 to-purple-950/95 border-purple-500";case"market":return"from-blue-900/95 to-blue-950/95 border-blue-500";default:return"from-slate-900/95 to-slate-950/95 border-slate-500"}})()),children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 overflow-hidden rounded-t-2xl bg-white/10",children:(0,a.jsx)("div",{className:"h-full w-full origin-left animate-[shrink_8s_linear] bg-white/50"})}),(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(s){case"school":return(0,a.jsx)(_.A,{className:"h-12 w-12 text-yellow-400"});case"hospital":return(0,a.jsx)(U.A,{className:"h-12 w-12 text-red-400"});case"religious":return(0,a.jsx)(B.A,{className:"h-12 w-12 text-purple-400"});case"market":return(0,a.jsx)(W.A,{className:"h-12 w-12 text-blue-400"});default:return(0,a.jsx)(i.A,{className:"h-12 w-12 text-yellow-400"})}})()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"mb-1 text-lg font-bold text-white",children:(()=>{switch(s){case"school":return"\uD83C\uDFEB School Zone";case"hospital":return"\uD83C\uDFE5 Hospital Zone";case"religious":return"\uD83D\uDD4C Religious Place";case"market":return"\uD83D\uDED2 Market Area";default:return"⚠️ Alert"}})()}),(0,a.jsx)("p",{className:"mb-2 text-sm font-medium text-slate-200",children:n}),(0,a.jsx)("p",{className:"text-sm text-slate-300",children:l}),c&&(0,a.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,a.jsxs)(w,{variant:"outline",className:"border-white/40 bg-white/10 text-white backdrop-blur-sm",children:["Speed Limit: ",c," km/h"]})}),"school"===s&&(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-yellow-200",children:[(0,a.jsx)(i.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Watch for children crossing the road"})]}),"hospital"===s&&(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-red-200",children:[(0,a.jsx)(i.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"No horn - Silence zone"})]})]})]}),(0,a.jsx)("p",{className:"mt-3 text-center text-xs text-white/60",children:"Tap to dismiss"})]})}):null}async function q(e){try{await fetch("/api/sos/trigger",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});{let e=document.createElement("a");e.href="tel:112",e.click()}return"Notification"in window&&"granted"===Notification.permission&&new Notification("\uD83D\uDEA8 EMERGENCY SOS ACTIVATED",{body:"Emergency services are being contacted. Help is on the way.",icon:"/icon-192.png",requireInteraction:!0}),"vibrate"in navigator&&navigator.vibrate([200,100,200,100,200]),{success:!0}}catch(e){return console.error("SOS trigger failed:",e),{success:!1,error:e}}}async function V(e){try{let t=JSON.parse(localStorage.getItem("emergency_contacts")||"[]");if(0===t.length)return void console.warn("No emergency contacts configured");let s=function(e){var t,s;let a=(t=e.position.lat,s=e.position.lng,"https://maps.google.com/?q=".concat(t,",").concat(s)),r=new Date(e.timestamp).toLocaleString();return"\n\uD83D\uDEA8 EMERGENCY ALERT \uD83D\uDEA8\n\n".concat(e.userName," needs help!\n\nLocation: ").concat(a,"\n\nTime: ").concat(r,"\nReason: ").concat("crash"===e.reason?"Crash Detected":"Manual SOS","\n").concat(e.gForce?"Impact Force: ".concat(e.gForce.toFixed(1),"g"):"","\n").concat(e.speed?"Speed: ".concat(e.speed," km/h"):"","\n\nThis is an automated message from SmartSafe.\n  ").trim()}(e);navigator.share?await navigator.share({title:"\uD83D\uDEA8 EMERGENCY ALERT",text:s}):(await navigator.clipboard.writeText(s),alert("Emergency message copied to clipboard. Please share with your contacts!"))}catch(e){console.error("Failed to send SOS to contacts:",e)}}function Y(e,t,s,a){let r=e=>e*Math.PI/180,n=r(s-e),l=r(a-t),i=Math.sin(n/2)*Math.sin(n/2)+Math.cos(r(e))*Math.cos(r(s))*Math.sin(l/2)*Math.sin(l/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371}let $=(0,n.default)(()=>Promise.all([s.e(804),s.e(121),s.e(335)]).then(s.bind(s,7335)).then(e=>({default:e.LiveMap})),{loadableGenerated:{webpack:()=>[7335]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-slate-900 rounded-2xl",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500"})})}),K={condition:"Light Rain",icon:"\uD83C\uDF27️",temperature:24,visibility:"2.1 km",windKph:18,humidity:65,precipitation:.5};function J(){var e,t,s;let n=(0,l.useRouter)(),[f,v]=r.useState({speed:0,distance:0,durationMinutes:0,risk:"LOW"}),[b,j]=r.useState(!0),[N,M]=r.useState(!0),[A,E]=r.useState(null),[D,R]=r.useState(null),H=function(){let[e,t]=r.useState(void 0);return r.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),s=()=>{t(window.innerWidth<768)};return e.addEventListener("change",s),t(window.innerWidth<768),()=>e.removeEventListener("change",s)},[]),!!e}(),{addLog:z}=k(),G=r.useRef(null),{position:F,error:_,watching:U,start:B,stop:W}=function(){let[e,t]=r.useState({position:null,error:null,watching:!1}),s=r.useRef(null),a=r.useCallback(()=>{if(!("geolocation"in navigator))return void t(e=>({...e,error:"Geolocation is not supported in this browser."}));if(null!=s.current)return;let e=navigator.geolocation.watchPosition(e=>{t({position:{lat:e.coords.latitude,lng:e.coords.longitude,accuracy:e.coords.accuracy,speed:e.coords.speed,heading:e.coords.heading,altitude:e.coords.altitude},error:null,watching:!0})},e=>{t(t=>({...t,error:e.message||"Unable to read GPS location.",watching:!1})),s.current=null},{enableHighAccuracy:!0,maximumAge:5e3,timeout:15e3});s.current=e,t(e=>({...e,watching:!0}))},[]),n=r.useCallback(()=>{null!=s.current&&(navigator.geolocation.clearWatch(s.current),s.current=null),t(e=>({...e,watching:!1}))},[]);return r.useEffect(()=>()=>{null!=s.current&&navigator.geolocation.clearWatch(s.current)},[]),{position:e.position,error:e.error,watching:e.watching,start:a,stop:n}}(),J=r.useRef(null),Q=r.useRef(null),[X,ee]=r.useState(null),[et,es]=r.useState([]),[ea,er]=r.useState(!1),[en,el]=r.useState(!1),[ei,ec]=r.useState(100),[eo,ed]=r.useState("unknown"),[em,ex]=r.useState(0),eu=r.useRef(null),[eh,ep]=r.useState(!1),[eg,ef]=r.useState(!1),[ev,eb]=r.useState({level:"warning",message:""}),[ew,ej]=r.useState(!1),[ey,eN]=r.useState({type:"school",name:"",message:""}),{crashDetected:ek}=function(e,t,s,a){let[n,l]=(0,r.useState)(!1),i=(0,r.useRef)({x:0,y:0,z:0}),c=(0,r.useRef)({alpha:0,beta:0,gamma:0}),o=(0,r.useRef)(Date.now()),d=(0,r.useRef)(0);(0,r.useRef)({alpha:0,beta:0,gamma:0});let m=(0,r.useRef)([]),x=(0,r.useRef)(null),u=(0,r.useRef)(null),h=(0,r.useRef)(!1),p=(0,r.useRef)([]),g=(0,r.useRef)(0),f=(0,r.useRef)([]),v=(0,r.useRef)({avgG:1,maxG:2}),b=(0,r.useRef)([]),w=(0,r.useRef)(0);return(0,r.useEffect)(()=>{d.current=t,p.current.push(t),p.current.length>10&&p.current.shift()},[t]),(0,r.useEffect)(()=>{if(!e)return;let t=setTimeout(()=>{f.current.length>0&&(v.current={avgG:f.current.reduce((e,t)=>e+Math.sqrt(t.x**2+t.y**2+t.z**2)/9.8,0)/f.current.length,maxG:Math.max(...f.current.map(e=>Math.sqrt(e.x**2+e.y**2+e.z**2)/9.8))},console.log("Baseline established:",v.current))},12e4);return(async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});x.current=new(window.AudioContext||window.webkitAudioContext);let t=x.current.createMediaStreamSource(e);u.current=x.current.createAnalyser(),u.current.fftSize=2048,t.connect(u.current),setInterval(()=>{if(!u.current)return;let e=new Uint8Array(u.current.frequencyBinCount);u.current.getByteFrequencyData(e);let t=e.reduce((e,t)=>e+t)/e.length;t>150&&(console.log("LOUD SOUND DETECTED:",t),h.current=!0,setTimeout(()=>{h.current=!1},2e3))},100)}catch(e){console.log("Audio detection not available:",e)}})(),()=>{clearTimeout(t),x.current&&x.current.close()}},[e]),(0,r.useEffect)(()=>{if(!e)return;let t=0,r=e=>{if(null===e.alpha||null===e.beta||null===e.gamma)return;let r=Date.now(),n=(r-o.current)/1e3;if(n<.1)return;let i=Math.abs(e.alpha-c.current.alpha),m=Math.abs(e.beta-c.current.beta);(t=Math.sqrt((i>180?360-i:i)**2+m**2+Math.abs(e.gamma-c.current.gamma)**2)/n)>90&&d.current>15&&(console.log("ROLLOVER DETECTED!",{rotationRate:t.toFixed(2),speed:d.current}),l(!0),a({gForce:0,timestamp:r,position:s,speed:d.current,crashType:"rollover",rotationRate:t})),c.current={alpha:e.alpha,beta:e.beta,gamma:e.gamma}},n=e=>{let r=e.accelerationIncludingGravity,n=e.rotationRate;if(!r||null===r.x||null===r.y||null===r.z)return;let c=Date.now(),x=(c-o.current)/1e3;if(x<.1)return;let u=Math.abs(r.x-i.current.x)/x,w=Math.sqrt(u**2+(Math.abs(r.y-i.current.y)/x)**2+(Math.abs(r.z-i.current.z)/x)**2),j=Math.sqrt(r.x**2+r.y**2+r.z**2)/9.8,y=0;n&&null!==n.alpha&&null!==n.beta&&null!==n.gamma&&(y=Math.sqrt(n.alpha**2+n.beta**2+n.gamma**2));let N=p.current.length>=2?p.current[0]-p.current[p.current.length-1]:0;m.current.push(j),m.current.length>5&&m.current.shift(),f.current.push({x:r.x,y:r.y,z:r.z,timestamp:c}),f.current.length>1200&&f.current.shift();let k=m.current.filter(e=>e>2.5).length>=3,S=j>1.5*v.current.maxG,M=f.current.slice(-10),A=(M.length>1?Math.sqrt(M.reduce((e,t,s)=>{if(0===s)return 0;let a=M[s-1];return e+Math.sqrt((t.x-a.x)**2+(t.y-a.y)**2+(t.z-a.z)**2)**2},0)/M.length):0)>50,E=Math.abs(r.z)>8&&12>Math.abs(r.z),C=new Date().getHours(),D=b.current.filter(e=>c-e.timestamp<36e5).length,R=s&&s.accuracy&&s.accuracy<20?5:0,I="unknown",T=Math.max(Math.abs(r.x),Math.abs(r.y),Math.abs(r.z));Math.abs(r.y)===T?I=r.y>0?"frontal":"rear":Math.abs(r.x)===T?I="side":(y>5||t>60)&&(I="rollover");let H=0,L=0;j>4?H+=25:j>3?H+=18:j>2.5&&(H+=10),L++,w>40?H+=20:w>30?H+=12:w>20&&(H+=8),L++,d.current>30?H+=15:d.current>20?H+=10:d.current>15&&(H+=5),L++,h.current&&(H+=12),L++,N>20?H+=10:N>10&&(H+=5),L++,k&&(H+=8),L++,S&&(H+=5),L++,A&&(H+=5),L++,H+=10*!!E,H+=C>=22||C<=6?-5:0,H-=5*D,H+=R,H=Math.min(100,Math.max(0,H));let z=j>4&&w>40&&d.current>20,G=j>3&&w>30&&d.current>15,O=(y>5||t>60)&&d.current>15,F=H>=65&&k&&d.current>15;if(c-g.current<1e4){i.current={x:r.x,y:r.y,z:r.z},o.current=c;return}(z||G||O||F)&&(console.log("CRASH DETECTED!",{totalG:j.toFixed(2),totalJerk:w.toFixed(2),speed:d.current,speedDrop:N.toFixed(1),crashType:I,rotationRate:(y||t).toFixed(2),soundDetected:h.current,confidence:H.toFixed(0)+"%",consistentImpact:k,isUnusualForUser:S,hasErraticPattern:A,phoneMounted:E,gpsAccurate:s&&s.accuracy&&s.accuracy<20}),g.current=c,l(!0),a({gForce:j,timestamp:c,position:s,speed:d.current,crashType:I,rotationRate:y||t,speedDrop:N,soundDetected:h.current,confidence:H})),i.current={x:r.x,y:r.y,z:r.z},o.current=c};return window.recordCrashFalsePositive=e=>{b.current.push({timestamp:Date.now(),reason:e}),w.current++,w.current>=3&&console.log("Adjusting detection sensitivity due to false positives")},"undefined"!=typeof DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then(e=>{"granted"===e&&(window.addEventListener("devicemotion",n),window.addEventListener("deviceorientation",r))}).catch(e=>{console.error("Motion permission denied:",e)}):(window.addEventListener("devicemotion",n),window.addEventListener("deviceorientation",r)),()=>{window.removeEventListener("devicemotion",n),window.removeEventListener("deviceorientation",r)}},[e,s,a]),{crashDetected:n,setCrashDetected:l}}(N&&b,f.speed,F,e=>{console.log("Crash detected!",e);let t="rollover"===e.crashType?"ROLLOVER":"frontal"===e.crashType?"FRONTAL IMPACT":"side"===e.crashType?"SIDE IMPACT":"rear"===e.crashType?"REAR IMPACT":"CRASH",s=e.confidence?" (".concat(Math.round(e.confidence),"% confidence)"):"";z("⚠️ ".concat(t," DETECTED").concat(s,"! Emergency services alerted"),"danger"),el(!0),ed(e.crashType||"unknown"),ex(e.confidence||0),ec(100),eH()}),{stats:eS}=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:60,n=arguments.length>4?arguments[4]:void 0,[l,i]=(0,r.useState)({harshBrakeCount:0,harshAccelCount:0,speedingCount:0,events:[]}),c=(0,r.useRef)(0),o=(0,r.useRef)(Date.now()),d=(0,r.useRef)(0);return(0,r.useEffect)(()=>{if(!e)return;let r=Date.now(),l=(r-o.current)/1e3;if(l<1)return;if(t<5){c.current=t,o.current=r;return}let m=(t-c.current)/3.6/l,x=null;if(m<-4?(x={type:"harsh_brake",timestamp:r,position:s,value:m,severity:"HIGH"},i(e=>({...e,harshBrakeCount:e.harshBrakeCount+1,events:[...e.events,x]}))):m<-3&&(x={type:"harsh_brake",timestamp:r,position:s,value:m,severity:"MEDIUM"},i(e=>({...e,harshBrakeCount:e.harshBrakeCount+1,events:[...e.events,x]}))),m>3?(x={type:"harsh_accel",timestamp:r,position:s,value:m,severity:"HIGH"},i(e=>({...e,harshAccelCount:e.harshAccelCount+1,events:[...e.events,x]}))):m>2.5&&(x={type:"harsh_accel",timestamp:r,position:s,value:m,severity:"MEDIUM"},i(e=>({...e,harshAccelCount:e.harshAccelCount+1,events:[...e.events,x]}))),t>a+10&&r-d.current>1e4){let e=t-a;x={type:"speeding",timestamp:r,position:s,value:t,severity:e>30?"HIGH":e>20?"MEDIUM":"LOW"},i(e=>({...e,speedingCount:e.speedingCount+1,events:[...e.events,x]})),d.current=r}x&&n&&n(x),c.current=t,o.current=r},[e,t,s,a,n]),{stats:l,resetStats:()=>{i({harshBrakeCount:0,harshAccelCount:0,speedingCount:0,events:[]})}}}(N&&eh,f.speed,F,60,e=>{if("harsh_brake"===e.type&&"HIGH"===e.severity?z("Harsh braking detected","warning"):"harsh_accel"===e.type&&"HIGH"===e.severity?z("Aggressive acceleration detected","warning"):"speeding"===e.type&&z("Overspeeding detected (".concat(Math.round(e.value)," km/h)"),"warning"),"speechSynthesis"in window&&f.speed>5){let t=e=>{let t=new SpeechSynthesisUtterance(e);t.lang="en-IN",window.speechSynthesis.speak(t)};"harsh_brake"===e.type&&"HIGH"===e.severity?t("Harsh braking detected. Brake gently to avoid skidding."):"harsh_accel"===e.type&&"HIGH"===e.severity?t("Aggressive acceleration. Smooth acceleration is safer and saves fuel."):"speeding"===e.type&&t("You are overspeeding. Current speed limit is 60 kilometers per hour.")}}),{drivingMinutes:eM,formattedDuration:eA,status:eE}=function(e,t,s){let[a,n]=(0,r.useState)(0),[l,i]=(0,r.useState)(0),c=(0,r.useRef)(s);return(0,r.useEffect)(()=>{c.current=s},[s]),(0,r.useEffect)(()=>{if(!e||!t)return void n(0);let s=setInterval(()=>{let e=Date.now(),s=Math.floor((e-t)/6e4);n(s);let a=e-l,r=new Date().getHours();s>=(r>=22||r<=6?60:120)&&s%30==0&&a>18e5&&(i(e),c.current&&c.current({level:"warning",message:"You have been driving for ".concat(Math.floor(s/60)," hours. Consider taking a break."),timestamp:e})),s>=240&&a>18e5&&(i(e),c.current&&c.current({level:"critical",message:"MANDATORY REST - You have been driving for 4 hours. Take a 15-minute break immediately.",timestamp:e}))},6e4);return()=>clearInterval(s)},[e,t,l]),{drivingMinutes:a,formattedDuration:(e=>{let t=Math.floor(e/60),s=e%60;return t>0?"".concat(t,"h ").concat(s,"m"):"".concat(s,"m")})(a),status:a<120?{level:"safe",color:"green"}:a<240?{level:"warning",color:"yellow"}:{level:"critical",color:"red"}}}(eh,Q.current,e=>{if(z("critical"===e.level?"⚠️ MANDATORY REST - 4 hours driving":"Take a break - 2 hours driving","critical"===e.level?"danger":"warning"),eb({level:e.level,message:e.message}),ef(!0),"speechSynthesis"in window){let t=new SpeechSynthesisUtterance(e.message);t.lang="en-IN",window.speechSynthesis.speak(t)}"vibrate"in navigator&&navigator.vibrate([200,100,200])}),{nearbyPOIs:eC,currentPOI:eD}=function(e,t,s){let[a,n]=(0,r.useState)([]),[l,i]=(0,r.useState)(null),c=(0,r.useRef)(null),o=(0,r.useRef)(null),d=(0,r.useRef)(s);return(0,r.useEffect)(()=>{d.current=s},[s]),(0,r.useEffect)(()=>{if(!t||!e){n([]),i(null);return}let s=async()=>{try{let t='\n          [out:json][timeout:25];\n          (\n            node["amenity"="school"](around:'.concat(500,",").concat(e.lat,",").concat(e.lng,');\n            node["amenity"="hospital"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            node["amenity"="clinic"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            node["amenity"="place_of_worship"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            node["shop"="mall"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            way["amenity"="school"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            way["amenity"="hospital"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,');\n            way["amenity"="place_of_worship"](around:').concat(500,",").concat(e.lat,",").concat(e.lng,");\n          );\n          out center;\n        "),s=await fetch("https://overpass-api.de/api/interpreter?data=".concat(encodeURIComponent(t)));if(!s.ok)return void console.error("Overpass API error:",s.status);let a=await s.json(),r=[];a.elements.forEach(t=>{var s,a;let n=t.lat||(null==(s=t.center)?void 0:s.lat),l=t.lon||(null==(a=t.center)?void 0:a.lon);if(!n||!l)return;let i=function(e,t,s,a){let r=e*Math.PI/180,n=s*Math.PI/180,l=(s-e)*Math.PI/180,i=(a-t)*Math.PI/180,c=Math.sin(l/2)*Math.sin(l/2)+Math.cos(r)*Math.cos(n)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371e3}(e.lat,e.lng,n,l),c="market";"school"===t.tags.amenity?c="school":"hospital"===t.tags.amenity||"clinic"===t.tags.amenity?c="hospital":"place_of_worship"===t.tags.amenity&&(c="religious");let o=t.tags.name||t.tags["name:en"]||"".concat(c.charAt(0).toUpperCase()+c.slice(1));r.push({id:t.id.toString(),type:c,name:o,lat:n,lng:l,distance:i})}),r.sort((e,t)=>e.distance-t.distance),n(r);let l=r.find(e=>e.distance<=200);if(l){i(l);let e=Date.now(),t=c.current;if(!t||t.type!==l.type||t.name!==l.name||e-t.time>12e4){let t=function(e){switch(e.type){case"school":return{type:"school",name:e.name,message:"School Zone ahead: ".concat(e.name,". Reduce speed to 30 km/h. Watch for children crossing."),speedLimit:30,timestamp:Date.now()};case"hospital":return{type:"hospital",name:e.name,message:"Hospital Zone: ".concat(e.name,". No horn. Reduce speed to 20 km/h. Emergency vehicles may be present."),speedLimit:20,timestamp:Date.now()};case"religious":return{type:"religious",name:e.name,message:"Religious place ahead: ".concat(e.name,". Drive slowly and avoid horn. Watch for pedestrians."),speedLimit:20,timestamp:Date.now()};case"market":return{type:"market",name:e.name,message:"Market area: ".concat(e.name,". Heavy pedestrian traffic. Drive carefully."),speedLimit:30,timestamp:Date.now()};default:return null}}(l);t&&d.current&&(d.current(t),c.current={type:l.type,name:l.name,time:e})}}else i(null)}catch(e){console.error("Failed to fetch POIs:",e)}};return s(),o.current=setInterval(s,1e4),()=>{o.current&&clearInterval(o.current)}},[null==e?void 0:e.lat,null==e?void 0:e.lng,t]),{nearbyPOIs:a,currentPOI:l}}(F,N&&eh,e=>{eN({type:e.type,name:e.name,message:e.message,speedLimit:e.speedLimit}),ej(!0);let t="school"===e.type?"\uD83C\uDFEB":"hospital"===e.type?"\uD83C\uDFE5":"religious"===e.type?"\uD83D\uDD4C":"\uD83D\uDED2";if(z("".concat(t," ").concat(e.name," ahead - ").concat(e.speedLimit," km/h"),"warning"),"speechSynthesis"in window){let t=new SpeechSynthesisUtterance(e.message);t.lang="en-IN",window.speechSynthesis.speak(t)}"vibrate"in navigator&&navigator.vibrate([300,100,300,100,300])});r.useEffect(()=>{B()},[B]),r.useEffect(()=>{F&&(async()=>{try{er(!0);let e=await fetch("/api/zones?lat=".concat(F.lat,"&lng=").concat(F.lng,"&radius=50"));if(e.ok){let t=await e.json();es(t.zones||[])}}catch(e){console.error("Failed to fetch zones:",e)}finally{er(!1)}})()},[null==F?void 0:F.lat,null==F?void 0:F.lng]),r.useEffect(()=>{try{"1"!==window.localStorage.getItem("smartsafe_logged_in")&&n.replace("/login")}catch(e){n.replace("/login")}},[n]),r.useEffect(()=>{if(!N||!F)return;let e=Date.now(),t=J.current;if(!t){J.current={lat:F.lat,lng:F.lng,timestamp:e,distanceKm:0},v({speed:0,distance:0,durationMinutes:0,risk:"LOW"});return}let s=(e-t.timestamp)/1e3;if(s<2)return;let a=Y(t.lat,t.lng,F.lat,F.lng),r=0;null!==F.speed&&F.speed>=0?r=Math.min(r=3.6*F.speed,200):a>.01&&(r=Math.min(r=a/(s/3600),200));let n=r>1?t.distanceKm+a:t.distanceKm,l=eh&&Q.current?(e-Q.current)/6e4:0,i="LOW",c=null;for(let e of et)if(1e3*Y(F.lat,F.lng,e.lat,e.lng)<=e.radiusMeters){c=e.id,"HIGH"===e.severity||r>60?i="HIGH":("MEDIUM"===e.severity||r>40)&&(i="MEDIUM");break}!c&&(r>80?i="HIGH":r>50&&(i="MEDIUM")),ee(c),v({speed:eh?Math.round(r):0,distance:Number(n.toFixed(2)),durationMinutes:Math.round(l),risk:i}),J.current={lat:F.lat,lng:F.lng,timestamp:e,distanceKm:n}},[N,F,et,eh]),r.useEffect(()=>{if(!F)return;async function e(){if(F)try{R(null);let e=await fetch("/api/weather?lat=".concat(F.lat,"&lng=").concat(F.lng));if(!e.ok)throw Error("Status ".concat(e.status));let t=await e.json();E(t)}catch(e){console.error("Failed to load weather",e),R("Live weather unavailable, using demo values."),E(K)}}e();let t=setInterval(e,6e4);return()=>clearInterval(t)},[null==F?void 0:F.lat,null==F?void 0:F.lng]),r.useEffect(()=>{if("speechSynthesis"in window)if("HIGH"===f.risk&&"HIGH"!==G.current){let e=new SpeechSynthesisUtterance("High accident risk ahead. This is a red zone. Reduce speed to forty kilometers per hour.");e.lang="en-IN",window.speechSynthesis.speak(e),G.current="HIGH"}else"HIGH"!==f.risk&&(G.current=f.risk)},[f.risk]);let eR="HIGH"===f.risk?"danger":"MEDIUM"===f.risk?"warning":"success",eI=null!=A?A:K,eT=null!=X&&null!=(s=et.find(e=>e.id===X))?s:null,eH=()=>{eu.current&&clearInterval(eu.current);let e=100;eu.current=setInterval(()=>{ec(--e),0===e&&(clearInterval(eu.current),eL())},1e3)},eL=async()=>{el(!1);let e=window.localStorage.getItem("smartsafe_user_name")||"User",t=window.localStorage.getItem("smartsafe_user_id")||"unknown";F&&(await q({userId:t,userName:e,position:F,timestamp:Date.now(),reason:"crash",speed:f.speed}),await V({userId:t,userName:e,position:F,timestamp:Date.now(),reason:"crash",speed:f.speed}))},ez=async()=>{let e=window.localStorage.getItem("smartsafe_user_name")||"User",t=window.localStorage.getItem("smartsafe_user_id")||"unknown";F&&(await q({userId:t,userName:e,position:F,timestamp:Date.now(),reason:"manual",speed:f.speed}),await V({userId:t,userName:e,position:F,timestamp:Date.now(),reason:"manual",speed:f.speed}))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I,{isOpen:en,onCancel:()=>{eu.current&&clearInterval(eu.current),el(!1),ec(100),window.recordCrashFalsePositive&&window.recordCrashFalsePositive("user_cancelled"),z("Crash alert cancelled by user","info")},onConfirm:eL,countdown:ei,crashType:eo,confidence:em}),(0,a.jsx)(P,{isOpen:eg,level:ev.level,message:ev.message,drivingTime:eA,onDismiss:()=>{ef(!1)},onFindRestStop:()=>{ef(!1),alert("Finding nearby rest stops... (Feature coming soon)")}}),(0,a.jsx)(Z,{isOpen:ew,type:ey.type,name:ey.name,message:ey.message,speedLimit:ey.speedLimit,onDismiss:()=>ej(!1)}),(0,a.jsx)("div",{className:"bg-slate-950/95",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-400",children:"Live Journey Monitor"}),(0,a.jsx)("h1",{className:"mt-2 text-2xl font-semibold tracking-tight text-white md:text-3xl",children:"SmartSafe Dashboard"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Real-time risk analysis, weather conditions, and safety guidance for your current trip."}),F&&(0,a.jsxs)("p",{className:"mt-1 text-[11px] text-emerald-400/80",children:["GPS locked at ",F.lat.toFixed(4),"\xb0, ",F.lng.toFixed(4),"\xb0 (\xb1",Math.round(F.accuracy)," m)"]}),_&&(0,a.jsxs)("p",{className:"mt-1 text-[11px] text-red-400/80",children:["GPS Error: ",_," - Please enable location permissions in your browser."]}),ea&&(0,a.jsx)("p",{className:"mt-1 text-[11px] text-blue-400/80",children:"Loading nearby accident zones..."}),!ea&&et.length>0&&(0,a.jsxs)("p",{className:"mt-1 text-[11px] text-yellow-400/80",children:[et.length," accident zone(s) detected within 50km radius"]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(O,{isActive:eh,duration:f.durationMinutes,onStart:()=>{ep(!0),Q.current=Date.now(),J.current=null,v({speed:0,distance:0,durationMinutes:0,risk:"LOW"}),z("Trip started","success")},onStop:()=>{ep(!1),z("Trip completed - ".concat(f.distance," km, ").concat(f.durationMinutes," min"),"info"),alert("Trip completed!\nDistance: ".concat(f.distance," km\nDuration: ").concat(f.durationMinutes," min\nSafety Score: ").concat(100-5*eS.harshBrakeCount-3*eS.harshAccelCount-10*eS.speedingCount))}})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900/60 px-3 py-2",children:[(0,a.jsx)("span",{className:"text-xs text-slate-400",children:"Live Mode"}),(0,a.jsx)(y,{checked:N,onCheckedChange:e=>M(e)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900/60 px-3 py-2",children:[(0,a.jsx)("span",{className:"text-xs text-slate-400",children:"GPS"}),(0,a.jsx)(g.$,{type:"button",size:"sm",variant:"outline",className:"h-7 px-3 text-[11px]",onClick:U?()=>W():()=>B(),children:U?"Stop GPS":"Enable GPS"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(p.Zp,{className:"bg-gradient-to-br from-emerald-500 to-teal-400 text-white",children:[(0,a.jsxs)(p.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(p.ZB,{className:"text-sm font-medium",children:"Risk Level"}),(0,a.jsx)(i.A,{className:"h-5 w-5"})]}),(0,a.jsx)(p.Wu,{children:(0,a.jsxs)("div",{className:"flex items-end justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-semibold",children:f.risk}),(0,a.jsx)("p",{className:"mt-1 text-xs text-emerald-50/80",children:"Calculated from speed, weather, and accident zone data."})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsx)(w,{variant:eR,className:"px-3 py-1 text-[11px]",children:"HIGH"===f.risk?"Immediate caution recommended":"MEDIUM"===f.risk?"Drive defensively":"Safe driving conditions"}),(0,a.jsx)("span",{className:"text-[10px] uppercase tracking-[0.18em] text-emerald-50/70",children:"LIVE"})]})]})})]}),(0,a.jsxs)(p.Zp,{className:"bg-slate-900/80",children:[(0,a.jsxs)(p.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(p.ZB,{className:"text-sm font-medium text-slate-200",children:"Trip Metrics"}),(0,a.jsx)(c.A,{className:"h-5 w-5 text-slate-400"})]}),(0,a.jsx)(p.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-slate-100",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Speed"}),(0,a.jsxs)("p",{className:"mt-1 text-xl font-semibold",children:[f.speed," km/h"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Distance"}),(0,a.jsxs)("p",{className:"mt-1 text-xl font-semibold",children:[f.distance.toFixed(1)," km"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Duration"}),(0,a.jsxs)("p",{className:"mt-1 text-xl font-semibold",children:[f.durationMinutes," min"]})]})]})})]}),(0,a.jsxs)(p.Zp,{className:"bg-slate-900/80",children:[(0,a.jsxs)(p.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(p.ZB,{className:"text-sm font-medium text-slate-200",children:"Weather & Visibility"}),(0,a.jsx)(o.A,{className:"h-5 w-5 text-slate-400"})]}),(0,a.jsxs)(p.Wu,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-slate-100",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Condition"}),(0,a.jsxs)("p",{className:"text-sm font-semibold flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"text-lg",children:eI.icon}),eI.condition]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,a.jsx)(d.A,{className:"h-3 w-3"})," ",eI.temperature,"\xb0C"]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Visibility"}),(0,a.jsxs)("p",{className:"text-sm font-semibold flex items-center gap-1.5",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-emerald-400"}),eI.visibility]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"h-3 w-3"})," ",eI.windKph," km/h"]})]})]}),eI.precipitation>0&&(0,a.jsxs)("div",{className:"mt-3 text-xs text-yellow-400 flex items-center gap-1",children:[(0,a.jsx)(o.A,{className:"h-3 w-3"}),"Precipitation: ",eI.precipitation," mm"]}),D&&(0,a.jsx)("p",{className:"mt-3 text-[11px] text-yellow-400",children:D}),!D&&F&&(0,a.jsx)("p",{className:"mt-3 text-[11px] text-emerald-400",children:"Live weather for your location"})]})]}),(0,a.jsx)(L,{harshBrakeCount:eS.harshBrakeCount,harshAccelCount:eS.harshAccelCount,speedingCount:eS.speedingCount})]}),(0,a.jsxs)("div",{className:"grid gap-4 lg:grid-cols-3",children:[(0,a.jsxs)(p.Zp,{className:"lg:col-span-2 bg-slate-900/80",children:[(0,a.jsxs)(p.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(p.ZB,{className:"text-sm font-medium text-slate-200",children:"Live Route & Accident Zones"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Real-time map with your location and nearby accident zones."})]}),!H&&(0,a.jsxs)(g.$,{variant:"outline",size:"sm",className:"border-slate-700 text-slate-200",children:[(0,a.jsx)(u.A,{className:"mr-2 h-3 w-3"}),"View analytics"]})]}),(0,a.jsxs)(p.Wu,{children:[(0,a.jsx)("div",{className:"h-96",children:(0,a.jsx)($,{userPosition:F,zones:et,currentZoneId:X})}),eT&&(0,a.jsx)("div",{className:"mt-4 rounded-xl border border-slate-800 bg-slate-900/60 p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 shrink-0 ".concat("HIGH"===eT.severity?"text-red-400":"MEDIUM"===eT.severity?"text-yellow-400":"text-green-400")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-medium ".concat("HIGH"===eT.severity?"text-red-300":"MEDIUM"===eT.severity?"text-yellow-300":"text-green-300"),children:eT.name}),(0,a.jsxs)(w,{variant:"outline",className:"text-[10px] ".concat("HIGH"===eT.severity?"border-red-500/60 text-red-300":"MEDIUM"===eT.severity?"border-yellow-400/60 text-yellow-300":"border-green-500/60 text-green-300"),children:[eT.severity," RISK"]})]}),(0,a.jsx)("p",{className:"text-sm text-slate-300",children:eT.message}),eT.city&&(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-2",children:["\uD83D\uDCCD ",eT.city,", ",eT.state]})]})]})}),!eT&&et.length>0&&(0,a.jsx)("div",{className:"mt-4 rounded-xl border border-slate-800 bg-slate-900/60 p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-300",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-emerald-400"}),(0,a.jsxs)("span",{children:[et.length," accident zone(s) nearby. Closest:"," ",(0,a.jsx)("strong",{className:"text-emerald-300",children:null==(e=et[0])?void 0:e.name})," (",null==(t=et[0])?void 0:t.distance.toFixed(1)," km away)"]})]})}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[(0,a.jsx)("span",{className:"inline-flex h-2 w-2 rounded-full bg-emerald-400"}),"Connected to emergency services (NHAI)"]}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900/60 px-3 py-2",children:[(0,a.jsx)(y,{checked:b,onCheckedChange:e=>j(e)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-200",children:"Auto SOS Dispatch"}),(0,a.jsx)("p",{className:"text-[11px] text-slate-500",children:"Sends location to 112 and nearest hospitals on impact."})]})]})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(C,{}),(0,a.jsx)(S,{})]})]}),(0,a.jsx)(p.Zp,{className:"border-slate-800 bg-slate-900/80",children:(0,a.jsxs)(p.Wu,{className:"flex flex-col gap-3 py-4 text-sm text-slate-200 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 text-emerald-400"}),(0,a.jsx)("span",{className:"font-medium",children:"System Health: Optimal"}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"All safety modules are running."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)(w,{variant:"outline",className:"border-emerald-500/60 text-[11px] text-emerald-300",children:"Weather AI online"}),(0,a.jsx)(w,{variant:"outline",className:"border-emerald-500/60 text-[11px] text-emerald-300",children:"Accident map synced"}),(0,a.jsx)(w,{variant:"outline",className:"border-emerald-500/60 text-[11px] text-emerald-300",children:"Voice control ready"}),(0,a.jsx)(w,{variant:"outline",className:F?"border-emerald-500/60 text-[11px] text-emerald-300":"border-slate-600 text-[11px] text-slate-300",children:F?"GPS active":"GPS not enabled"})]})]})})]})}),(0,a.jsx)(T,{onTriggerSOS:ez})]})}}},e=>{e.O(0,[121,76,358],()=>e(e.s=54)),_N_E=e.O()}]);